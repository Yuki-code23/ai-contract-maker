# **Antigravity 開発指示用マスター資料**

## **1\. プロジェクトの背景**

本プロジェクトは、既存の契約書自動生成アプリ「AI Contract Maker」を拡張し、契約締結後の「期限管理」および「請求書発行・送付」を完全自動化するB2B SaaSの開発である。

## **2\. 実装済み機能（ベースライン）**

開発を継続するにあたり、以下の機能がすでに実装されていることを前提とする。

* **URL**: https://ai-contract-maker-6niv.vercel.app/  
* **主要機能**:  
  * Google認証（Firebase Auth）  
  * AIによる契約書本文の自動生成（Gemini API使用）  
  * 契約書詳細のプレビュー表示  
  * 作成済み契約書のリスト表示

## **3\. 追加開発の全体像**

既存の契約書生成プロセスに、以下のオートメーション・パイプラインを統合する。

### **A. AIによるデータ構造化抽出**

契約書が確定した際、Geminiを用いて本文から以下の項目をJSONとして抽出し、Firestoreへ保存せよ。

* end\_date: 契約終了日  
* notice\_period\_days: 更新/解約通知期限  
* billing\_amount: 請求金額（税抜/税込）  
* payment\_deadline: 支払期日ロジック（例：翌月末）

### **B. 契約期限アラート・更新機能**

* 終了日の90日/30日前をトリガーとした通知ロジック。  
* 「既存契約データを引き継いだ更新契約書生成」ボタンの設置。

### **C. 請求書管理システム（最優先実装）**

* **請求書リスト画面**: 契約データから自動予約（Planned）された請求一覧。  
* **PDF生成**: インボイス制度対応フォーマットでの請求書出力。  
* **自動送付**: 承認後のメール自動送信機能。

## **4\. Antigravity への具体的指示事項**

### **ステップ1：データベース拡張**

既存の契約書ドキュメントに対し、metadata フィールドを追加し、AI抽出データを格納するスキーマ変更を行ってください。

### **ステップ2：請求書確認画面（List/Detail）の実装**

* Billing コレクションを作成し、契約データに基づいた請求レコードを管理してください。  
* 画面レイアウトは既存の「AI Contract Maker」のクリーンなUIを継承し、Tailwind CSSで構築してください。

### **ステップ3：アラートエンジン（Cloud Functions）**

* end\_date を毎日チェックし、期限が迫っている場合にユーザーへ通知（Firestoreへのメッセージ登録）を行うロジックを実装してください。

## **5\. 技術スタック指定**

* **Frontend**: React (Next.js), Tailwind CSS  
* **Backend**: Firebase (Auth, Firestore, Functions, Storage)  
* **AI**: Gemini 2.5 Flash / Pro  
* **Icons**: Lucide-React

## **6\. 注意点**

* 既存の「AI Contract Maker」のデザインシステム（フォント、配色、角丸、余白感）を厳守すること。  
* モバイルレスポンシブを必須とする。  
* alert() は使用せず、カスタムトーストまたはモーダルでフィードバックを行うこと。