# **請求書作成・管理機能 仕様書**

## **1\. 概要**

本機能は、インボイス制度に対応した請求書の作成、発行、および回収状況の管理を効率化するためのシステムです。直感的なエディタとダッシュボードにより、事務作業の負担を軽減します。

## **2\. 画面構成と機能詳細**

### **2.1 ダッシュボード**

システムの起点となる画面です。

* **売上サマリー**:  
  * 今月の請求合計金額（税込）の表示  
  * 未回収金額（ステータスが「発行済」のもの）の可視化  
  * 支払い期限超過案件のアラート通知  
* **クイックアクセス**:  
  * 「新規請求書作成」ボタン  
  * 直近で編集した請求書へのショートカット

### **2.2 請求書エディタ**

請求書を動的に作成するメイン機能です。

* **入力フォーム**: 取引先選択、発行日、支払い期日、請求番号の入力。  
* **動的な品目追加**:  
  * 行の追加・削除機能。  
  * 品目、数量、単位、単価、税率（0%, 8%, 10%）の入力。  
* **自動計算**: 小計、税率ごとの消費税額、総合計をリアルタイムで算出。  
* **リアルタイムプレビュー**: 入力内容を即座に反映したPDF形式のプレビュー表示。

### **2.3 履歴管理画面**

過去に作成した請求書の一覧・操作画面です。

* **一覧表示項目**: 請求番号、請求日、取引先名、合計金額、ステータス（下書き / 発行済 / 入金済）。  
* **アクション**:  
  * PDFダウンロード  
  * 「コピーして作成」（既存データを元に新規作成）  
  * 削除機能  
  * ステータス変更（「入金済」への更新など）

### **2.4 自社情報・設定**

請求書に反映される情報の管理画面です。

* **プロフィール設定**:  
  * 自社名、住所、連絡先。  
  * **インボイス対応**: 適格請求書発行事業者登録番号の登録。  
  * **印影アップロード**: 請求書に表示する角印・担当者印の画像設定。  
* **デフォルト設定**:  
  * 標準的な支払い期日の設定（例：翌月末）  
  * 振込先口座情報（銀行名、支店名、口座番号、名義）

## **3\. データ構造 (TypeScript)**

インボイス制度の要件（税率ごとに区分した消費税額の明記）に対応した構造です。

/\*\*  
 \* 請求書品目  
 \*/  
type InvoiceItem \= {  
  description: string; // 品目  
  quantity: number;    // 数量  
  unit: string;        // 単位  
  unitPrice: number;   // 単価  
  taxRate: 0 | 8 | 10; // 税率 (0: 非課税/免税, 8: 軽減税率, 10: 標準税率)  
};

/\*\*  
 \* 取引先情報  
 \*/  
type ClientInfo \= {  
  id: string;  
  name: string;  
  postalCode: string;  
  address: string;  
  department?: string;  
};

/\*\*  
 \* 請求書データ本体  
 \*/  
type Invoice \= {  
  id: string;  
  number: string;      // 請求番号 (例: INV-2024-001)  
  issueDate: string;   // 発行日 (ISO 8601\)  
  dueDate: string;     // 支払い期日  
  client: ClientInfo;  // 取引先データ  
  items: InvoiceItem\[\];  
  subtotal: number;    // 小計 (税抜金額の合計)  
  taxTotal: {          // 消費税額合計（インボイス必須要件：税率ごとに区分）  
    tax8: number;      // 8%対象の消費税額  
    tax10: number;     // 10%対象の消費税額  
  };  
  total: number;       // 総合計 (税込)  
  status: 'draft' | 'issued' | 'paid'; // 下書き | 発行済 | 入金済  
};

## **4\. インボイス制度への対応方針**

1. **登録番号の表示**: 自社設定で登録した「T+13桁」の番号を書類上に明記。  
2. **税率ごとの区分**: 商品ごとに税率を適用し、末尾に「8%対象合計」「10%対象合計」およびそれぞれの「消費税額」を算出・表示。  
3. **端数処理**: 消費税計算における1円未満の端数処理（切り捨て/四捨五入）をシステム内で統一。